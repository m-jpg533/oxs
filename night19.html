<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI NIGHT MODE</title>

<style>
html,body{
  margin:0;
  background:#000;
  overflow:hidden;
  color:#0f0;
  font-family:monospace;
}
#radar{
  width:100vw;
  height:100vh;
  background:radial-gradient(circle,#00ff66 2%,#000 70%);
  animation:spin 4s linear infinite;
}
@keyframes spin{
  from{transform:rotate(0deg)}
  to{transform:rotate(360deg)}
}
#hud{
  position:fixed;
  top:12px;
  left:12px;
  z-index:10;
  font-size:18px;
}
#startScreen{
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:99;
}
#startBtn{
  font-size:22px;
  padding:20px 40px;
  border-radius:12px;
  border:none;
  background:#00ffcc;
  color:#000;
}
</style>
</head>

<body>

<div id="radar"></div>

<div id="hud">
  <div id="location">ğŸ“¡ ç­‰å¾…å•Ÿå‹•</div>
  <div id="temp">ğŸŒ¡ --</div>
  <div id="weather">â˜ï¸ --</div>
</div>

<div id="startScreen">
  <button id="startBtn">â–¶ TAP TO START AI NIGHT</button>
</div>

<audio id="music" loop>
  <source src="https://m-jpg533.github.io/oxs/59.mp3.mp4" type="audio/mpeg">
</audio>

<script>
/* === DOM === */
const music = document.getElementById("music");
const startBtn = document.getElementById("startBtn");
const screen = document.getElementById("startScreen");
const radar = document.getElementById("radar");

const locEl = document.getElementById("location");
const tempEl = document.getElementById("temp");
const weatherEl = document.getElementById("weather");

/* ğŸ”— GAS Web Appï¼ˆå›å‚³å…¨å°é™£åˆ—ï¼‰ */
const GAS_URL = "https://script.google.com/macros/s/AKfycbwpoMFZlysadmfRZHtpD44Y2dKrsnRYz06ON0Ds4OI5Mm57ifPhRGdJRb7HBObb2A/exec";

/* === å…¨å°è³‡æ–™ === */
let weatherList = [];
let index = 0;

/* === å•Ÿå‹•ï¼ˆè§£é–éŸ³è¨Šï¼‰ === */
startBtn.onclick = async () => {
  await music.play();
  screen.style.display = "none";
  loadAllWeather();
};

/* === æŠ“å…¨å°æ°£è±¡ === */
function loadAllWeather(){
  fetch(GAS_URL)
    .then(r => r.json())
    .then(data => {
      weatherList = data;   // âš ï¸ data å¿…é ˆæ˜¯é™£åˆ—
      showWeather();
      setInterval(showWeather, 10000); // æ¯ 10 ç§’æ›ç¸£å¸‚
    })
    .catch(err=>{
      locEl.innerText = "âŒ æ°£è±¡è®€å–å¤±æ•—";
      console.error(err);
    });
}

/* === é¡¯ç¤ºå–®ä¸€ç¸£å¸‚ === */
function showWeather(){
  if(weatherList.length === 0) return;

  const w = weatherList[index];

  locEl.innerText = "ğŸ“ " + w.location;
  tempEl.innerText = `ğŸŒ¡ ${w.minT} ~ ${w.maxT} Â°C`;
  weatherEl.innerText = "â˜ï¸ " + w.weather;

  /* é›·é”æ•ˆæœ */
  if(w.weather.includes("é›¨")){
    radar.style.background = "radial-gradient(circle,#00ccff,#000)";
    radar.style.animationDuration = "8s";
  }else{
    radar.style.background = "radial-gradient(circle,#00ff66,#000)";
    radar.style.animationDuration = "4s";
  }

  index = (index + 1) % weatherList.length;
}
</script>

</body>
</html>
